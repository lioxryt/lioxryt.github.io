<html>
  <head>
    <title>Random Meme Generator</title>
    <style>
      body {
        background-color: #000000;
      }
      button {
        background-color: #171717;
        border: none;
        color: rgb(255, 255, 255);
        padding: 10px 24px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        border-radius: 100px;
      }
      form {
        display: flex;
      }
      input {
        border: none;
        background-color: #171717;
        color: #ffffff;
        padding: 10px;
        font-size: 16px;
        border-radius: 100px;
      }
    </style>
  </head>
  <body>
    <h1
      id="title"
      style="
        font-size: 36;
        font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS',
          sans-serif;
        color: #ffffff;
      "
    >
      Random Reddit Meme
    </h1>
    <h1
      id="caption"
      style="
        font-size: 20;
        font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS',
          sans-serif;
        color: #ffffff;
      "
    ></h1>
    <img
      id="memeImg"
      src=""
      alt="Random Meme"
      onerror="setMemeImage()"
      style="height: 75vh; width: auto"
    />
    <h1
      id="link"
      style="
        font-size: 11;
        font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS',
          sans-serif;
        color: #ffffff;
      "
    ></h1>
    <h1
      id="info"
      style="
        font-size: 11;
        font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS',
          sans-serif;
        color: #ffffff;
      "
    ></h1>
    <br />
    <br />
    <form id="subredditForm">
      <input type="text" id="subredditInput" placeholder="Enter subreddits" />
      <button type="submit">Update Subreddits</button>
    </form>
    <button id="refreshButton">Load Another Meme</button>
    <script>
      // Array of subreddit names
      let subreddits = [];

      // Function to get a random subreddit from the array
      function getRandomSubreddit() {
        return subreddits[Math.floor(Math.random() * subreddits.length)];
      }

      // Function to get a random meme from the subreddit
      async function getRandomMeme(subreddit) {
        const response = await fetch(
          `https://www.reddit.com/r/${subreddit}/random.json`
        );
        const data = await response.json();
        const post = data[0].data.children[0].data;
        return {
          url: post.url,
          permalink: post.permalink,
          caption: post.title,
          subreddit: post.subreddit,
          ups: post.ups,
        };
      }

      // Function to set the src attribute and caption of the meme image
      async function setMemeImage() {
        const subreddit = getRandomSubreddit();
        const {
          url,
          permalink,
          caption,
          subreddit: postSubreddit,
          ups,
        } = await getRandomMeme(subreddit);
        const link = document.createElement("a");
        link.href = `https://www.reddit.com${permalink}`;
        link.textContent = `Post Link`;
        document.getElementById("memeImg").src = url;
        document.getElementById("link").textContent = `Link: `;
        document.getElementById("link").appendChild(link);
        document.getElementById(
          "info"
        ).textContent = `Sub: ${postSubreddit} | Upvotes: ${ups}`;
        document.getElementById("caption").textContent = `${caption}`;
      }

      // Set the initial meme image
      setMemeImage();

      // Add an event listener to the refresh button to set a new meme image when clicked
      document
        .getElementById("refreshButton")
        .addEventListener("click", setMemeImage);

      // Add an event listener to the subreddit form to update the subreddits array and set a new meme image when submitted
      document
        .getElementById("subredditForm")
        .addEventListener("submit", (event) => {
          event.preventDefault();
          const input = document.getElementById("subredditInput");
          subreddits = input.value.split(",").map((s) => s.trim());
          input.value = "";
          setMemeImage();
        });
    </script>
  </body>
</html>
